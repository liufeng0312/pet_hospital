# 手机预览配置说明

## 问题说明

手机预览时无法访问 `localhost:8080`，因为手机和电脑不在同一网络环境。

## 解决方案

已将API地址更新为局域网IP: `http://172.20.10.3:8080`

## 使用步骤

### 1. 确保手机和电脑在同一WiFi网络

- 电脑连接WiFi
- 手机也连接同一个WiFi

### 2. 在微信开发者工具中配置

1. 打开微信开发者工具
2. 点击右上角"详情"
3. 勾选"不校验合法域名、web-view（业务域名）、TLS 版本以及 HTTPS 证书"
4. 保存设置

### 3. 生成预览二维码

1. 点击工具栏的"预览"按钮
2. 使用手机微信扫描二维码
3. 在手机上测试登录功能

## 注意事项

> [!WARNING]
> **网络要求**
> - 手机和电脑必须在同一WiFi网络
> - 如果更换WiFi，需要重新获取IP并更新配置
> - 某些公司或学校WiFi可能限制设备间通信

> [!IMPORTANT]
> **IP地址变化**
> - 当前IP: `172.20.10.3`
> - 如果电脑重启或更换网络，IP可能会变化
> - 需要重新运行命令获取新IP: `ifconfig | grep "inet " | grep -v 127.0.0.1`

## 获取当前IP地址

如果需要重新获取IP地址：

```bash
# Mac/Linux
ifconfig | grep "inet " | grep -v 127.0.0.1

# Windows
ipconfig | findstr IPv4
```

然后更新 `src/api/request.ts` 中的 `baseURL`。

## 生产环境配置

生产环境需要：
1. 申请域名并备案
2. 配置HTTPS证书
3. 在微信公众平台配置服务器域名
4. 将 `baseURL` 改为: `https://your-domain.com`

## 常见问题

### Q: 手机扫码后显示"网络错误"
**A**: 
1. 检查手机和电脑是否在同一WiFi
2. 检查电脑防火墙是否阻止8080端口
3. 尝试在手机浏览器访问 `http://172.20.10.3:8080/api/employees/doctors` 测试连通性

### Q: 提示"不在以下request合法域名列表中"
**A**: 
在微信开发者工具中勾选"不校验合法域名"选项

### Q: IP地址变了怎么办
**A**: 
1. 重新获取IP地址
2. 更新 `src/api/request.ts` 中的 `baseURL`
3. 重新编译小程序（会自动热更新）
4. 重新生成预览二维码
